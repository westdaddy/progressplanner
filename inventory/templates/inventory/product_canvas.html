{% extends "inventory/base.html" %}
{% load static %}

{% block title %}Product Canvas{% endblock %}

{% block content %}
<div class="section">
  <div class="row">
    <div class="col s12">
      <h4 class="header">Product Canvas</h4>
      <p class="grey-text text-darken-1">
        Drag and resize products on the Fabric.js canvas to plan merchandising layouts.
        Use the buttons below to save a layout locally or export an image snapshot of the current arrangement.
      </p>
      <div class="card-panel teal lighten-5">
        <div class="section">
          <a class="btn teal" id="save-layout"><i class="material-icons left">save</i>Save Layout</a>
          <a class="btn grey lighten-1 black-text" id="load-layout"><i class="material-icons left">refresh</i>Load Saved Layout</a>
          <a class="btn amber darken-2" id="clear-layout"><i class="material-icons left">clear</i>Clear Layout</a>
          <a class="btn cyan darken-2" id="export-layout"><i class="material-icons left">image</i>Export PNG</a>
        </div>
      </div>
      <div id="product-canvas-container" class="white z-depth-1" data-products='{{ product_canvas_json|default:"[]"|safe }}'>
        <canvas id="product-canvas" style="width: 100%; height: 70vh;"></canvas>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extrajs %}
  {{ block.super }}
  <script src="https://cdn.jsdelivr.net/npm/fabric@5.3.0/dist/fabric.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="{% static 'product-canvas.js' %}"></script>
{% endblock %}
